<html>

<head>
    <meta charset="UTF-8">
    <script language="javascript" type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.min.js"></script>

    <script type="text/javascript" src="https://www.gstatic.com/firebasejs/3.6.3/firebase.js"></script>
    <script language="javascript" type="text/javascript" src="sketch.js"></script>


</head>



<style type="text/css">  
  #blinkText {
  position: absolute;
  animation: blinker 1s linear infinite;
  color: white;

}
  .images {
  position: absolute;
  clip-path: inset(10px 20px 30px 40px);
}
  .myimg {
    clip-path: inset(10px 20px 30px 40px);
  }
 
 textarea{

    color: rgb(70,50,50);
    background-color: rgba(255, 217, 102,0.3);
    justify-content: center;
    text-transform: uppercase;
    font-weight: bold;
    border: none;
    outline: none;
    font-family:  monospace;
    /*border:solid 0.5px rgba(255, 217, 102,0.9);*/
}

@keyframes blinker {  
  50% { opacity: 0; }
}
    #blinkText {
        position: absolute;
        animation: blinker 1s linear infinite;
        color: white;

    }

    .images {
        position: absolute;
        clip-path: inset(10px 20px 30px 40px);
    }

    .myimg {
        clip-path: inset(10px 20px 30px 40px);
    }

    body {
        cursor: url(http://www.rw-designer.com/cursor-extern.php?id=126861);
    }

    @keyframes blinker {
        50% {
            opacity: 0;
        }
    }
</style>

<body>
    <div id="canvascontainer"></div>
    <textarea id="txt" rows="4" cols="50">
    </textarea>
    <div id="images" style="z-index: 1000">
        <img id="myimg" hidden style="z-index: 3000">
        <div>

            <button id="saveButton" style="z-index: 1000">Guardar</button>
            <button id="textButton" style="z-index: 1000">T</button>
            <button onclick="dragAll()" id="gifButton">GIF</button>
            <button id="modeButton" style="z-index: 1000">Text</button>

        </div>
    </div>
    <!-- <div id="blinkText" style="z-index: 1000">
   <p> 
  Muro de la persona que te invit√≥
   </p>
   <img src="assets/images/arrow.png" width="40">
  </div> -->


    <!-- <ol id="drawinglist">

    </ol>-->
    <script type="text/javascript">

        // Make the DIV element draggable:

        var imgRef;
        var movingTxt = 0;
        var block = 0;

        firebaseConfig = {
            apiKey: "AIzaSyBo4BBv2muAE4Y-yvJ90SYmn5fdwy5L84k",
            authDomain: "nueva-constitucion.firebaseapp.com",
            databaseURL: "https://nueva-constitucion-default-rtdb.firebaseio.com",
            projectId: "nueva-constitucion",
            storageBucket: "nueva-constitucion.appspot.com",
            messagingSenderId: "197438903025",
            appId: "1:197438903025:web:f7bb1385df1724038c0f50",
            measurementId: "G-VNK3XJS5Z5"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        var database = firebase.database();
        var storageRef = firebase.storage().ref();



        var ref = database.ref('drawings');
        ref.on('value', gotData, errData);

        var inptKey = localStorage.uKey;
        storageRef.child('/images/' + inptKey + '.jpg').getDownloadURL().then(function (url) {
            // `url` is the download URL for 'images/stars.jpg'

            // This can be downloaded directly:
            console.log("hi");

            // Or inserted into an <img> element:
            imgRef = document.getElementById('myimg');
            imgRef.src = url;
        }).catch(function (error) {
            // Handle any errors
        });




        function dragAll() {
            var imgs = document.getElementsByClassName("images");
            for (i = 0; i < 10; i++) {
                dragElement(imgs.item(i));
            }
        }

        function dragElement(elmnt) {
            var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            if (document.getElementById(elmnt.id + "header")) {
                // if present, the header is where you move the DIV from:
                document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
            } else {
                // otherwise, move the DIV from anywhere inside the DIV:
                elmnt.onmousedown = dragMouseDown;
            }

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // get the mouse cursor position at startup:
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                // call a function whenever the cursor moves:
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                e.preventDefault();
                // calculate the new cursor position:
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                // set the element's new position:
                elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
            }

            function closeDragElement() {
                // stop moving when mouse button is released:
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

    /*
    const el = document.querySelector(".text");

    el.addEventListener('mousedown',mousedown);

    function mousedown(e){
        window.addEventListener('mousemove',mousemove);
        window.addEventListener('mouseup',mouseup);
        movingTxt = 1;

        let prevX = e.clientX;
        let prevY = e.clientY;

        function mousemove(e){

            let newX = prevX - e.clientX;
            let newY = prevY - e.clientY;

            const rect = el.getBoundingClientRect();

            el.style.left = rect.left - newX + "px";
            el.style.top = rect.top - newY + "px";

            prevX = e.clientX;
            prevY = e.clientY;
        }

        function mouseup() {
            window.removeEventListener('mousemove',mousemove);
            window.removeEventListener('mouseup',mouseup);
            movingTxt = 0;
        }



    } */

    var textButton = document.getElementById("textButton");
    var canvascontainer = document.getElementById("canvascontainer");
    textButton.addEventListener("click",createTxt);

    function createTxt() {
        var x = document.createElement("TEXTAREA");
        x.addEventListener('mouseover',blockCanvas,true);
        x.addEventListener('mouseout',unblockCanvas,true);
        canvascontainer.appendChild(x);
        x.id = "inTxt"
        movingTxt = 1;
        
        window.addEventListener('click',clicked2,true);

        function clicked2() {
            x.id = "inTxt2";
<<<<<<< HEAD
            x.addEventListener('drag', function(){
                console.log('text area being dragged')
            })
=======
            x.className = "text";
>>>>>>> 8f404379f45c59f672e15b967fb51f15c68ea3eb
            movingTxt = 0;
            window.removeEventListener('click',clicked2);
            
        }



    }

    function blockCanvas() {
        block = 1;
    }

    function unblockCanvas() {
        block = 0;
    }






    </script>
</body>

</html>